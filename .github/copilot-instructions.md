<!-- Copilot / AI agent instructions for the Radar_2D_SoC project -->
# Quick orientation

- **Purpose:** FPGA-based 2D radar / telemetry SoC built for a DE10‑Lite (Intel MAX10) platform. Main HDL sources are in `src/`; simulation artifacts live in `simu/`; the Quartus/Platform Designer project and generated outputs are under `fit/`.
- **Top-level system:** `fit/DE10_Lite_Computer_YD/Computer_System.qsys` (Platform Designer/Qsys). It instantiates a Nios II CPU, VGA subsystem, SDRAM controller and many PIO/timer IPs.

# Immediate actionable workflows

- Run functional simulation (ModelSim/Questa): change to `simu/telemetre_us` and run the provided dofile:

  ```powershell
  cd simu/telemetre_us
  vsim -do simu.do    # or open ModelSim and `do simu.do`
  ```

  Note: `simu/telemetre_us/simu.do` uses relative paths (`vcom ../../src/telemetre_us.vhd`) so run it from that directory.

- Build/synthesize in Quartus (Windows with Quartus installed): open the Quartus project file `fit/DE10_Lite_Computer_YD/DE10_Lite_Computer.qpf` in Quartus or compile from the project directory:

  ```powershell
  cd fit/DE10_Lite_Computer_YD
  quartus_sh --flow compile DE10_Lite_Computer
  ```

  Recommended Quartus family: project was generated with IP version ~18.1 — prefer a matching or compatible Quartus release.

- Regenerating Platform Designer/Qsys outputs: edit `fit/DE10_Lite_Computer_YD/Computer_System.qsys` in Platform Designer and click "Generate". From command line you can call the qsys generator if available (Quartus tools):

  ```powershell
  cd fit/DE10_Lite_Computer_YD
  qsys-generate Computer_System.qsys --synthesis=rtl
  ```

# Project conventions & patterns (concrete)

- Sources: `src/` contains hand-written VHDL (DUTs and utilities). Example patterns:
  - `src/telemetre_us.vhd` — state-machine based sensor controller (TRIGGER/WAIT_ECHO/etc.).
  - `src/binary_to_sevseg_3dig.vhd` — numeric conversion to active‑LOW 7‑segment patterns (bits order `a b c d e f g`).

- Testbench & simulation layout:
  - Testbenches are named `tb_*` and held under `simu/` (e.g., `simu/telemetre_us/tb_telemetre_us.vhd`).
  - Dofile-driven simulation (use `vcom`/`vsim` as in `simu/*.do`).

- Generated/derived artifacts:
  - `fit/` contains Quartus outputs, generated HDL and Qsys outputs (e.g. `fit/DE10_Lite_Computer_YD/Computer_System/`). Do not edit generated files directly — edit the .qsys or original sources and re-generate.

- Naming and style hints for edits:
  - Keep testbench stimulus in `simu/` and device RTL in `src/`.
  - Maintain signal naming consistent with Qsys interfaces when adding RTL that will be integrated into `Computer_System.qsys` (look at the `interface` tags in that file).

# Integration points & dependencies

- The system uses Platform Designer (Qsys) to glue signals and provide Avalon-MM/Conduit interfaces. Addresses and IRQ mappings are declared in `fit/DE10_Lite_Computer_YD/Computer_System.qsys`.
- Nios II presence: software that talks to hardware is placed under `fit/.../software` (generated by BSP). If you change memory map or peripheral names, regenerate BSP/software.
- Simulation requires a VHDL simulator that supports `vcom`/`vsim` (ModelSim-Altera or Questa recommended).

# Troubleshooting tips (found from repo)

- If simulation fails to find entities, ensure you run the `simu` dofiles from the `simu/...` directory (paths in the dofiles are relative).
- If timing or IP mismatch occurs when compiling, use the Quartus version matching IP (qsys modules show version `18.1`); regenerate Qsys/Platform Designer outputs after edits.

# When to ask for help / what I cannot infer

- Missing hardware constraints (pin assignments) and programmer scripts are in `fit/*` — if you need to change pinout or IO standards, point me to the `.qsf` or pin planner exports to update them correctly.
- If you want me to add CI (sim/regression), provide preferred simulator (ModelSim vs Questa) and whether the CI runner will have Quartus installed.

---
If you want, I can: (1) run a quick simulation locally in the workspace, (2) add a small CONTRIBUTING.md with build presets, or (3) tweak this help message to include more low-level commands. Which would you prefer?
